# 技术债务AI识别演练 - 10分钟实战

## 🎯 演练目标

在10分钟内完成一个完整的技术债务AI识别流程，掌握基本的识别方法和处理策略。

## ⏰ 时间安排

- **准备阶段**：1分钟
- **识别阶段**：4分钟
- **分析阶段**：3分钟
- **决策阶段**：2分钟

---

## 📋 演练场景

**背景**：你是某电商公司的技术负责人，需要评估订单处理模块的技术债务状况。

**给定代码**：以下是订单处理核心代码

```java
public class OrderProcessor {
    // 魔法数字
    private static final int MAX_ITEMS = 50;
    private static final int VIP_DISCOUNT = 15;
  
    // 命名不规范  
    private PaymentService ps;
    private InventoryService is;
    private NotificationService ns;
  
    // 方法过长，复杂度高
    public OrderResult processOrder(OrderRequest request) {
        // 参数校验缺失
        List<OrderItem> items = request.getItems();
      
        // 深度嵌套逻辑
        if(items != null) {
            if(items.size() <= MAX_ITEMS) {
                double totalAmount = 0;
                for(int i = 0; i < items.size(); i++) {
                    OrderItem item = items.get(i);
                    if(item != null) {
                        // 重复计算逻辑
                        if(is.checkStock(item.getProductId()) >= item.getQuantity()) {
                            double price = item.getPrice();
                            if(request.getCustomer().isVip()) {
                                price = price * (100 - VIP_DISCOUNT) / 100;  // 内联计算
                            }
                            totalAmount += price * item.getQuantity();
                        } else {
                            // 错误处理不统一
                            System.out.println("库存不足: " + item.getProductId());
                            return new OrderResult("failed", "inventory_shortage");
                        }
                    }
                }
              
                // 支付处理
                if(ps.charge(request.getCustomer(), totalAmount)) {
                    // 库存扣减  
                    for(OrderItem item : items) {
                        is.decreaseStock(item.getProductId(), item.getQuantity());
                    }
                    // 通知发送
                    ns.sendOrderConfirmation(request.getCustomer().getEmail());
                    return new OrderResult("success", "order_processed");
                } else {
                    return new OrderResult("failed", "payment_failed");
                }
            }
        }
        return new OrderResult("failed", "invalid_request");
    }
}
```

---

## 🔍 第一步：快速债务识别（4分钟）

### 🚨 代码质量债务检查清单

**指令**：阅读上述代码，在下表中勾选发现的问题

| 债务类型           | 发现问题        | 具体位置                              | 严重程度 |
| ------------------ | --------------- | ------------------------------------- | -------- |
| **命名规范** | ☐ 变量名不规范 | `ps`, `is`, `ns`                | 🟡 中    |
| **魔法数字** | ☐ 硬编码常量   | `MAX_ITEMS=50`, `VIP_DISCOUNT=15` | 🟡 中    |
| **方法长度** | ☐ 方法过长     | `processOrder` 方法40+行            | 🟠 中高  |
| **圈复杂度** | ☐ 嵌套过深     | 4层if嵌套                             | 🔴 高    |
| **重复代码** | ☐ 逻辑重复     | 两次遍历items                         | 🟡 中    |
| **异常处理** | ☐ 处理不统一   | 混用return和System.out                | 🟠 中高  |
| **单一职责** | ☐ 职责混乱     | 一个方法处理多个业务                  | 🔴 高    |

### 🎯 快速AI分析模拟

**使用AI工具（模拟结果）**：

```json
{
  "complexity_score": 8.5,
  "debt_hours": 12,
  "critical_issues": [
    "High cyclomatic complexity: 12 (threshold: 10)",
    "Method too long: 42 lines (threshold: 20)",
    "Multiple responsibilities in single method"
  ],
  "suggestions": [
    "Extract payment logic to separate method",
    "Extract validation logic to separate method", 
    "Use proper exception handling instead of return codes"
  ]
}
```

---

## 📊 第二步：债务影响分析（3分钟）

### 🎯 影响评估矩阵

**指令**：根据识别出的债务，填写影响评估

| 债务问题                 | 业务影响           | 修复难度           | 优先级 | 预估工时 |
| ------------------------ | ------------------ | ------------------ | ------ | -------- |
| **圈复杂度过高**   | 🔴 高 - 容易出bug  | 🟠 中 - 需要重构   | P1     | 4小时    |
| **方法职责过多**   | 🟠 中 - 难以维护   | 🟠 中 - 方法拆分   | P1     | 3小时    |
| **异常处理不统一** | 🟠 中 - 用户体验差 | 🟡 低 - 统一处理   | P2     | 2小时    |
| **变量命名不规范** | 🟡 低 - 可读性差   | 🟢 低 - 简单重命名 | P3     | 0.5小时  |

### 🎲 债务风险评估

**当前状况**：

- **维护风险**：🔴 高 - 修改容易引入新bug
- **扩展风险**：🔴 高 - 添加新功能困难
- **团队效率**：🟠 中 - 新人理解成本高
- **业务影响**：🟠 中 - 影响订单处理稳定性

---

## 💡 第三步：修复决策（2分钟）

### 🎯 修复策略选择

**选择最适合的策略**：

#### 策略A：立即全面重构

- ✅ 彻底解决问题
- ❌ 耗时较长（9.5小时）
- ❌ 业务风险较高

#### 策略B：分步骤优化（推荐）

- ✅ 风险可控
- ✅ 可快速见效
- ✅ 适合敏捷开发

#### 策略C：暂时忽略

- ✅ 不影响当前交付
- ❌ 债务继续累积
- ❌ 后续成本更高

### 📋 行动计划模板

**本Sprint行动计划**：

```
🎯 高优先级（本Sprint必须完成）
- [ ] 拆分processOrder方法（3小时）
- [ ] 统一异常处理机制（2小时）

🎯 中优先级（下Sprint完成）  
- [ ] 降低圈复杂度（4小时）
- [ ] 提取业务逻辑到服务层（2小时）

🎯 低优先级（技术债务Sprint）
- [ ] 重命名变量和常量（0.5小时）
- [ ] 添加单元测试（3小时）
```

---

## ✅ 演练总结

### 🎯 学习收获检查

**请勾选你已掌握的技能**：

- ☐ 能快速识别常见技术债务类型
- ☐ 会使用AI工具辅助债务分析
- ☐ 能评估债务的业务影响
- ☐ 会制定优先级和修复计划
- ☐ 理解债务管理的基本策略

### 🎲 关键要点回顾

1. **识别要点**：代码复杂度、职责单一性、异常处理
2. **评估要点**：业务影响 × 修复难度 = 优先级
3. **决策要点**：分步骤处理，控制风险
4. **执行要点**：融入Sprint计划，持续改进

### 🚀 下一步行动

**在实际工作中应用**：

1. 选择一个你负责的模块
2. 使用今天学到的方法进行债务识别
3. 制定一个实际可执行的改进计划
4. 在团队中分享你的发现和计划

---

## 📚 延伸阅读

- 《重构：改善既有代码的设计》- Martin Fowler
- 《代码整洁之道》- Robert C. Martin
- 《技术债务管理实战》- 企业最佳实践

**工具推荐**：

- SonarQube：代码质量分析
- CodeClimate：技术债务评估
- PMD/SpotBugs：Java静态分析

---

*演练完成时间：____分钟*
*学员签名：________________*
