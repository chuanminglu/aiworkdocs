@startuml 整体情感得分计算流程活动图
!theme materia

title 整体情感得分计算流程
|数据输入|
start
:原始消息文本;
note right: 例如："这个功能很棒我们一起优化"

|文本预处理|
:中文分词 jieba.cut;
note right
  分词结果：
  ["这个", "功能", "很", "棒", 
   "我们", "一起", "优化"]
end note

:情感词典匹配;
note right
  匹配结果：
  "棒": +2
  "一起": +1.5
  "优化": +1
end note

|情感分类|
split
  :积极词汇识别;
  :积极分数 +1~+3]
split again
  :消极词汇识别;
  :消极分数 -1~-3]
split again
  :中性词汇识别;
  :中性分数 0]
end split

:单条消息情感分值计算;
note right
  计算公式：
  (积极得分 + 消极得分) / 词汇总数
  归一化到 -1.0 ~ 1.0 区间
end note

|批量处理|
:批量消息分析;
:情感分类统计;

split
  :积极消息占比 45%]
split again
  :中性消息占比 32%]
split again
  :消极消息占比 23%]
end split

|加权计算|
:整体情感得分计算;
note right
  计算公式：
  (积极占比×1.0 + 中性占比×0.5 + 消极占比×0.0) × 10
  
  示例计算：
  (0.45×1.0 + 0.32×0.5 + 0.23×0.0) × 10
  = (0.45 + 0.16 + 0) × 10 = 6.1分
end note

|结果输出|
if (得分 >= 8.0?) then (是)
  :优秀状态 (绿色);
  note right: 8.0-10.0分
elseif (得分 >= 6.0?) then (是)
  :良好状态 (蓝色);
  note right: 6.0-7.9分
elseif (得分 >= 4.0?) then (是)
  :预警状态 (黄色);
  note right: 4.0-5.9分
else (否)
  :危险状态 (红色);
  note right: 0.0-3.9分
endif

:最终得分: 6.1分;

|数据存储|
:更新数据库;
:通知UI刷新;

stop

@enduml
